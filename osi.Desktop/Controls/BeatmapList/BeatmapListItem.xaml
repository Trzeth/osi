<local:BaseMessage x:Class="osi.Desktop.BeatmapListItem"
                   x:Name="Control"
                   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                   xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                   xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                   xmlns:local="clr-namespace:osi.Desktop"
                   mc:Ignorable="d" 
                   d:DesignHeight="90" d:DesignWidth="400"
                   xmlns:core="clr-namespace:osi.Core;assembly=osi.Core">
    <local:BaseMessage.Resources>
        <Style x:Key="ContentStyle" TargetType="{x:Type ContentControl}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ContentControl}">
                        <Grid Margin="5">
                            <Grid.Effect>
                                <DropShadowEffect ShadowDepth="0" Opacity="0.2" />
                            </Grid.Effect>

                            <Grid x:Name="Grid">
                                <local:BeatmapInfoBar PanelWidth="{Binding ElementName=Panel,Path=ActualWidth}" 
                                                      CornerRadius="3"
                                                      Height="{Binding ElementName=Grid,Path=ActualHeight}"
                                                      Width="{Binding ElementName=Control,Path=ActualWidth}"
                                                      BeatmapList="{Binding Path=Beatmaps}"/>
                                
                                <Grid HorizontalAlignment="Left">
                                    <Border x:Name="Container" CornerRadius="3"
                                            Background="{StaticResource BackgroundLightBrush}"/>

                                    <!-- Beatmapset Information -->
                                    <Grid x:Name="Panel" 
                                          SnapsToDevicePixels="True" 
                                          Background="{StaticResource BackgroundLightBrush}">

                                        <Grid.OpacityMask>
                                            <VisualBrush Visual="{Binding ElementName=Container}"/>
                                        </Grid.OpacityMask>

                                        <Grid UseLayoutRounding="True">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width='*'/>
                                                <ColumnDefinition Width='Auto'/>
                                            </Grid.ColumnDefinitions>

                                            <Image Height="70"  MinWidth="90" Stretch="UniformToFill" Source="{Binding Path=BeatmapsetId,Converter={local:BeatmapsetIdToImageConverter}}"/>

                                            <Grid Grid.Column="1" Margin="5,5">
                                                <StackPanel VerticalAlignment="Top">
                                                    <TextBlock FontSize="{StaticResource FontSizeRegular}"
                                                           Text="{Binding Title}"
                                                           />
                                                    <TextBlock FontSize="{StaticResource FontSizeSmall}"
                                                           Foreground="{StaticResource ForegroundVeryDarkBrush}"
                                                           Text="{Binding Artist}"
                                                           />
                                                </StackPanel>

                                                <StackPanel VerticalAlignment="Bottom" Orientation="Horizontal">
                                                    <TextBlock FontSize="{StaticResource FontSizeSmall}"
                                                           Text="{Binding Creator}"
                                                           Foreground="{StaticResource ForegroundVeryDarkBrush}"
                                                           />
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Style="{StaticResource IconTextBlock}"
                                                               FontSize="{StaticResource FontSizeSmall}"
                                                               Text="{StaticResource FontAwesomeHeartIcon}"
                                                               Foreground="{StaticResource ForegroundVeryDarkBrush}"
                                                               Margin="10,0,5,0"
                                                               />


                                                        <TextBlock FontSize="{StaticResource FontSizeSmall}"
                                                               Text="{Binding FavouriteCount}"
                                                               Foreground="{StaticResource ForegroundVeryDarkBrush}"
                                                               >
                                                        </TextBlock>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Grid>

                                            <Button Grid.Column="2"
                                                    Margin="5,0,0,0"
                                                    BorderThickness="0"
                                                    Style="{StaticResource IconButtonStyle}"
                                                    Background="Transparent"
                                                    Padding="10"
                                                    Command="{Binding ClickCommand}">
                                                    <TextBlock Style="{StaticResource IconTextBlock}"
                                                           Text="{StaticResource FontAwesomeDownloadIcon}"
                                                           FontSize="{StaticResource FontSizeXXLarge}"
                                                           Foreground="{StaticResource OsuGreenVeryDarkBrush}"/>
                                            </Button>
                                        </Grid>
                                    </Grid>
                                    
                                </Grid>
                            </Grid>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </local:BaseMessage.Resources>

    <ContentControl Style="{StaticResource ContentStyle}"
                    d:DataContext="{x:Static core:BeatmapListItemDesignModel.Instance}"/>
</local:BaseMessage>
